#!/usr/bin/env node

// bs4bundle

var fs = require('node:fs');
var path = require('node:path');
var { chdir, cwd } = require('node:process');
var { Io } = require('../src/vendor/util/io');
var { spawn, spawnSync } = require('node:child_process');

const binFile = require.main.filename;
const binDir = path.dirname(binFile);
const pkgRoot = path.resolve(binDir, '..');

var [, , raw] = process.argv;

process.chdir(pkgRoot);

if (!raw) {
    Io.info('Usage: bs4bundle grunt:<task>');
    spawnSync('grunt', ['--help'], { stdio: 'inherit' });
    process.exit(1);
}

var parts = raw.split(':');
var runner = parts.shift();
var task = parts.join(':');

if (runner !== 'grunt') {
    Io.error('Unknown runner: ' + runner);
    process.exit(1);
}


spawnSync('grunt', [task], { stdio: 'inherit' })
process.exit(1);
